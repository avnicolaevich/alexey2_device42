function throttle(c,a,b){a||(a=250);var d,e;return function(){var h=b||this;var g=+new Date,f=arguments;if(d&&g<d+a){clearTimeout(e);e=setTimeout(function(){d=g;c.apply(h,f)},a)}else{d=g;c.apply(h,f)}}}function onElementHeightChange(e,d){var b=e.clientHeight,a;(function c(){a=e.clientHeight;if(b!=a){d()}b=a;if(e.onElementHeightChangeTimer){clearTimeout(e.onElementHeightChangeTimer)}e.onElementHeightChangeTimer=setTimeout(c,200)})()}$(function(){var h=$("#changelist");var f=$(".sticky_marker").first();var g=$(".results").first();var e=$("#changelist .actions");var k=$("#toolbar");var n=$(".paginator");var j=$("#changelist thead");var b=j.clone(true);var l=j.find("th");var a=$("#changelist-filter");var i=j.find("th #action-toggle").parents("div.text").first();var d=false;var c=new m();function o(){if(a.length>0){a.css("max-height",$(window).height()+"px")}}function m(){var p=this;p.isFixed=false;p.lastScrollTop=0;this.init=function(){if(b.length>0){b.css({top:k.outerHeight(),left:0}).addClass("sticky fixed-header").find("th #action-toggle").parents("div.text").first().remove();j.after(b);if(i){b.find("th").first().append(i)}p.updateFixedHeaderPos()}this.observeToTableChange()};this.refreshColumnsWidth=function(){b.width(j.width()+3);b.find("th").each(function(t){var u=$(l[t]);var w=u.width();var s=g.offset();var r=$(this);r.innerWidth(w);var v=r.offset();var q=u.offset();if(a.length>0&&(q.left>a.offset().left||q.left+u.width()<s.left)){r.hide()}else{r.show();if(q.left<s.left){r.outerWidth(u.next().offset().left-s.left)}else{r.innerWidth(w)}}})};this.onTableScroll=function(){p.refreshColumnsWidth();var r=g.scrollTop();var q=p.lastScrollTop-r<0?1:-1;if(q==1){if(!p.isFixed&&r>0){p.isFixed=true;$("html, body").animate({scrollTop:$("#changelist").offset().top},500)}}else{if(q==-1){p.isFixed=false}}p.lastScrollTop=r+0;p.updateFixedHeaderPos()};this.updateFixedHeaderPos=function(){var q=e.length&&e.is(":visible")?e.outerHeight():0;if(b){var r=k.is(":visible")?k.outerHeight():0;b.css({top:k.outerHeight()+q})}g.css({"max-height":"calc(100vh - "+(k.outerHeight()+n.outerHeight()+q)+"px)"})};this.observeToTableChange=function(){var s=throttle(function(u){p.refreshColumnsWidth()},100);var q=new MutationObserver(function(u){s()});var r={attributes:true,childList:true,subtree:true,characterData:true};var t=document.getElementById("result_list");if(t){q.observe(t,r)}};this.init()}$(".results").on("scroll",function(){c.onTableScroll()});$("#toolbar").bind("DOMSubtreeModified",function(){c.updateFixedHeaderPos()});$(window).resize(function(){c.onTableScroll()});onElementHeightChange($(document),c.updateFixedHeaderPos);c.onTableScroll();$("#go-to-bottom").remove()});